## Backend для приложения с объявлениями + Telegram бот
___

### Описание backend части на django

Простой бекенд для мобильного приложения с объявлениями. 
Можно просматривать, создавать, редактировать, удалять объявления, 
добавлять или исключать их из избранного.

__Пользователь может__:

+ _без авторизации:_
  + просматривать объявления в статусе `OPEN`, `CLOSED`
  + фильтровать объявления по дате и статусу
  

+ _с авторизацией:_
  + создавать объявления
    + не более 10 открытых объявлений на пользователя
    + валидация заголовка и описания
  + просматривать свои черновики в статусе `DRAFT`
  + обновлять объявления
  + добавлять в Избранное
    + нельзя добавлять свои же объявления
  + просматривать свое Избранное

Обновлять объявление может только автор этого объявления или администратор.
Удаление возможно только администратором.

_Для защиты установлен лимит на запросы:_
- для неавторизованных пользователей: 10 запросов в минуту
- для авторизованных пользователей: 20 запросов в минуту

__

### Описание части Telegram бота

Бот позволяет взаимодействовать с данными приложения через Telegram:

- видит данные существующей базы django
- отображает данные из БД, фильтрует, создает новые записи, удаляет
- авторизация по логину и паролю с записью токена
- logout (становятся недоступны инлайны, доступно базовое меню)
- пароль удаляется из чата после ввода при авторизации
- поиск по фильтру - по названию и описанию
- реализована валидация данных при создании/редактировании объявления


- __2 базовые команды__:
    - __/start__ - для начала работы
    - __/cancel__ - бля сброса ввода данных и возврата в пользовательское меню. Доступно также по вводу слова "отмена" в чат


- __для неавторизованного пользователя__:
    - просмотр всех объявлений, 
    - поиск объявлений, 
    - авторизация


- __для авторизованного пользователя__:
  - просмотр всех объявлений с инлайн-опцией добавить в избранное
  - просмотр объявлений поиска с инлайн-опцией добавить в избранное
  - "черновики" - просмотр своих черновиков
  - "избранное" - просмотр своего избранного
    - удаление из избранного по инлайн-кнопке
  - "мои объявления" - просмотр своих объявлений во всех статусах
  - отображаются инлайновые кнопки действий (изменить/удалить) на 
  своих объявлениях
    - редактирование своих объявлений по кнопке в инлайне
    - удаление своего объявления по инлайн-кнопке в моих, черновиках
  - создание нового объявления, добавляется в базу
  - выход из аккаунта
  
Полностью повторяет функционал django, позволяя полноценно 
взаимодействовать с БД не только через REST API и админку, но и с помощью
Telegram

___

## Документация по проекту

+ __Бот в telegram__: test_dj_tg_336699_bot
+ Для тестирования можно использовать данные пользователя:
  + _логин_: admin
  + _пароль_: admin

__

**Локальный запуск:**

Для запуска **django** проекта необходимо:

+ Установить зависимости:

```bash
pip install -r requirements.txt
```

+ Cоздать БД
```bash
python manage.py migrate
```

+ Выполнить команду:
```bash
python manage.py runserver
```

Для запуска бота дополнительно:

+ Запускаем файл `app.py` из директории `tg_bot_localhost_async`

__

__Запуск через терминал:__

```bash
pip install -r requirements.txt
```

```bash
python manage.py migrate
python manage.py runserver

# для запуска app.py с ботом
python manage.py runscript -v2 app  
```
__

__Запуск в docker:__

```bash
docker-compose up --build
```

Автоматически будет доступен и сервер, и бот.

___

### Форматирование и линтинг

+ Для форматирования используется __black__.
+ Для линтинга используется __flake8__.